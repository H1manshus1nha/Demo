<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My TODO App</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@000;600&display=swap" rel="stylesheet">
    <style>
        /* Basic Reset & Global Styles */
        *, *::before, *::[after{
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top, not center vertically */
            min-height: 100vh;
            padding: 20px;
        }

        /* Container */
        .container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 100%;
            max-width: 500px;
            margin-top: 50px; /* Space from top */
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.2em;
            font-weight: 600;
        }

        /* Todo Form */
        #todo-form {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        #todo-input {
            flex-grow: 1;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            outline: none;
            transition: border-color 0.3s ease;
        }

        #todo-input:focus {
            border-color: #3498db;
        }

        #todo-form button {
            padding: 12px 20px;
            background-color: #3498db;
            color: white;
            border: none;             border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        #todo-form button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        #todo-form button:active {
            transform: translateY(0);
        }

        /* Todo List */
        #todo-list {
            list-style: none;
            padding: 0;
        }

        .todo-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 10px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }

        .todo-item:last-child {
            margin-bottom: 0;
        }

        .todo-item:hover {
            background-color: #f0f0f0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .podo-item.completed {
            background-color: #e8f5e9; /* Light green for completed */
            border-color: #c8e6c9;
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: #888;
        }

        .todo-text {
            flex-grow: 1;
            font-size: 1.1em;
            word-break: break-word; /* Prevents long words from overflowing */
            margin-right: 15px;
        }

        .todo-actions {
            display: flex;
            gap: 8px;
        }

        .todo-actions button {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .todo-actions .complete-btn {
            background-color: #2ecc71; /* Green */
            color: white;        }

        .todo-actions .complete-btn:hover {
            background-color: #27ae60;
            transform: translateY(-1px);
        }

        .todo-actions .delete-btn {
            background-color: #e74c3c; /* Red */
            color: white;
        }

        .todo-actions .delete-btn:hover {
            background-color: #c0392b;
            transform: translateY(-1px);
        }

        /* Empty State Message */
        .empty-state {
            text-align: center;
            color: #777;
            font-style: italic;
            padding: 20px;
            border: 1px dashed #ccc;
            border-radius: 8px;
            margin-top: 20px;
        }

        .empty-state.hidden {
            display: none;
        }

        /* Responsive Design */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin-top: 20px;
            }

            h1 {
                font-size: 1.8em;
                margin-bottom: 20px;
            }

            #todo-form {
                flex-direction: column;
                gap: 15px;
            }

           #hodo-form button {
                width: 100%;
            }

            .todo-item {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px;
            }

            .todo-text {
                margin-bottom: 10px;
                margin-right: 0;
                font-size: 1em;
            }

            .todo-actions {
                width: 100%;
                justify-content: flex-end; /* Align buttons to the right */
            }

            .todo-actions button {
                flex-grow: 1; /* Make buttons fill available space */
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>My Todo List</h1>

        <form id="todo-form">
            <input type="text" id="todo-input" placeholder="Add a new todo..." aria-label="New todo item" required>
            <button type="submit">Add Todo</button>
        </form>

        <ul id="todo-list">
            <!-- Todo items will be dynamically added here by JavaScript -->
        </ul>

        <div id="empty-state" class="empty-state">
            <p>No todos yet! Add one above.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
              // 1. Get DOO Elements
              const todoForm = document.getElementById('todo-form');
              const todoInput = document.getElementById('todo-input');
              const todoList = document.getElementById('todo-list');
              const emptyState = document.getElementById('empty-state');

              // 2. Initialize Todos Array from localStorage
              let todos = JSON.parse(localStorage.getItem('todos')) || [];

              // 3. Function to Save Todos to localStorage
              const saveTodos = () => {
                    localStorage.setItem('todos', JSON.stringify(todos));
                    renderTodos(); // Re-render after saving to reflect changes
              };

              // 4. Function to Render Todos
              const renderText = () => {
                    todoList.innerHTML = ''; // Clear existing list items

                    if (todos.length === 0) {
                        emptyState.classList.remove('hidden');
                    } else {
                        emptyState.classList.add('hidden');
                    }

                    todos.forEach(todo => {
                        const listItem = document.createElement('li');
                        listItem.classList.add('todo-item');
                        if (todo.completed) {
                             listItem.classList.add(completed');
                        }
                        listItem.dataset.id = todo.id; // Store todo ID on the list item

                        listItem.innerHTML = `
                             <span class="todo-text">${todo.text}</span>
                            <div class="todo-actions">
                                <button class="complete-btn" aria-label="${todo.completed ? 'Mark as incomplete' : 'Mark as complete'}">
                                  {todo.completed ? 'Uncomplete' : 'Complete'}
                            </button>
                              <button class="delete-btn" aria-label="Delete todo">Delete</button>
                            </div>
                        `;                      todoList.appendChild(listItem);
                });
              };

              // 5. Function to Add a Todo
              const addTodo = (event) => {
                    event.preventDefault(); // Prevent default form submission (page reload)

                    const todoText = todoInput.value.trim();
                    if (todoText === '')) {
                        alert('Please enter a todo item!');
                        return;
                    }

                    const newTodo =
                        id: Date.now(), // Unique ID for the todo
                        text: todoText,
                        completed: false
                    };

                    todos.push(newTodo);
                    saveTodos(); // Save and re-render
                    todoInput.value = ''; // Clear input field
              };

              // 6. Function to Toggle Todo Completion
              const toggleComplete = (id) => {
                    todos = todos.map(todo =>
                        todo.id === id ? { ...todo, completed: !todo.completed } : todo
                  );
                    saveTodos(); // Save and re-render
              };

              // 7. Function to Delete a Todo
              const deleteText = (id) => {
                    todos = todos.filter(todo => todo.id !== id);
                    saveTodos(); // Save and re-render
              };

              // 8. Event Listeners
              todoForm.addEventListener('submit', addTodo);

              // Event delegation for complete and delete buttons
              todoList.addEventListener('click', (event) => {
                    const target = event.target;
                    const listItem = target.closest('.todo-item'); // Find the parent todo-item

                    if (!listItem) return; // If click wasn't inside a todo-item

                    const todoId = parseInt(listItem.dataset.id); // Get the ID from the data attribute
                    if (target.classList.contains('complete-btn')) {
                        toggleComplete(todoId);
                    } else if (target.classList.contains('delete-btn')) {
                        deleteText(todoId);
                    }
              });

              // 9. Initial Render on Page Load
              renderTodos();
        });
    </script>
</body>
</html>